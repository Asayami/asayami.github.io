<!DOCTYPE html>
<html>
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-3NTSMWGK5D"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-3NTSMWGK5D");
    </script>
    <meta charset="UTF-8" />
    <title>Rootkit</title>
    <link
      rel="icon"
      type="image/png"
      href="https://asayami.github.io/favicon.png"
    />
    <link
      rel="stylesheet"
      href="https://asayami.github.io/theme/notebook.css"
    />
    <link rel="stylesheet" href="https://asayami.github.io/theme/theme.css" />
    <script src="https://asayami.github.io/theme/notebook.js"></script>
    <script src="https://asayami.github.io/theme/theme.js"></script>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <meta
      name="description"
      content="Những bài viết, kinh nghiệm của mình về malware"
    />
    <meta name="keywords" content="Hacking, hack, malware, virus, assembly" />
    <meta name="author" content="Asayami Kurashin" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <div id="themeSpace"></div>
    <script>
      loadNavbar();
    </script>

    <img class="mainPicture" src="malware_source/rev_shell_bg.jpg" />
    <div class="paragraph">
      <h3>Rootkit là gì?</h3>
      <p>
        Rootkit là một loại phần mềm được thiết kế để ẩn sự hiện diện của chính
        nó (hoặc phần mềm khác), can thiệp vào hệ thống ở mức thấp (thường là
        kernel mode), và tránh bị phát hiện bởi hệ điều hành hoặc phần mềm bảo
        mật.
      </p>
      <h3>Phân loại rootkit (theo mức độ truy cập)</h3>
      <ul>
        <li>
          User mode rootkit: Chạy ở chế độ người dùng, có quyền hạn chế hơn.
          Thường sử dụng các kỹ thuật như hooking để can thiệp vào các ứng dụng
          hoặc dịch vụ (Hook API qua IAT - Import Address Table của .dll, EAT,
          hoặc inline patching các hàm Windows API như ReadFile,
          NtQueryDirectoryFile,...). Dễ viết, ít rủi ro crash hệ thống nhưng
          cũng dễ bị phát hiện bởi AV.
        </li>
        <li>
          Kernel mode rootkit: Là driver .sys, chạy ở Ring 0, có quyền truy cập
          đầy đủ vào hệ thống. Có thể thay đổi các hàm hệ thống và cấu trúc dữ
          liệu của kernel. Có thể hook SSDT, IRP, IDT, v.v.. Khó viết hơn, dễ
          làm BSOD hệ thống, nhưng khó phát hiện hơn.
        </li>
      </ul>
      <h3>Một số kỹ thuật rootkit kernel-mode thường dùng</h3>
      <ul>
        <li>
          Hook SSDT (System Service Descriptor Table) - bảng chứa địa chỉ Native
          API
        </li>
        <li>Hook IRP (I/O Request Packet) - hàm có sẵn trong driver object</li>
        <li>
          Hook IDT (Interrupt Descriptor Table) - bảng chứa interrupt handler
        </li>
        <li>...</li>
      </ul>
    </div>
  </body>
</html>
